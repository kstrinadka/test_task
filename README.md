# Тестовое задание в ШИФТ Лаб
## Стринадка Кирилл Александрович (3 курс ФИТ НГУ)

Очень хочется мне к вам на стажировку попать)))
Я готов много учиться и исправлять свои ошибки.
Я понимаю, что в этом проекте много мест, которые можно доработать (например, тесты добавить,
нормальную документацию написать, добавить обработку ошибок, UML всякие порисовать и т.д.)


### Постановка задачи
Магазин, торгующий компьютерами и комплектующими со следующим типом товаров:
- Настольные компьютеры 
- Ноутбуки 
- Мониторы 
- Жесткие диски

Каждый товар имеет следующие свойства: 
- номер серии 
- производитель 
- цена 
- количество единиц продукции на складе

Дополнительные свойства товаров: 
- Настольные компьютеры имеют форм-фактор: десктопы, неттопы, моноблоки 
- Ноутбуки подразделяются по размеру: 13, 14, 15, 17 дюймовые 
- Мониторы имеют диагональ • Жесткие диски имеют объем

Необходимо реализовать back-end приложение, которое имеет RESTful HTTP методы выполняющие: 
1) Добавление товара 
2) Редактирование товара 
3) Удаление товара 
4) Просмотр всех существующих товаров по типу 
5) Просмотр товара по идентификатору

Требования к реализации 
1) Реализация должна быть выполнена на языке Java или Kotlin 
2) В качестве базы данных использовать in memory database, например H2


## Для реализации проекта использовались:
- Spring boot
- Spring Data JPA
- H2 data base
- Lombok


## БД:
Основной сущностью товара является **ShopEntity**, от которой наследуются сущности
конкретных товаров: **HddEntity**, **LaptopEntity**, **PcEntity**, **ScreenEntity**

![DB_scheme](https://github.com/kstrinadka/test_task/tree/master/src/main/resources/static/DB_scheme.png)

Используется Одна таблица для каждого подкласса, 
где отношение “is a” представлено в виде «has a»,
т.е. – связь по внешнему ключу с использованием JOIN.

Получается 6 основных полей сущности конкретного продукта наследуют от ShopEntity + внутри
конкретного продукта определяется характерное для него свойство (поле). Уникальный идентификатор
совпадает для одного и того же товара в таблицах SHOP_TABLE и таблице для конкретного товара.


### Подключение к интерфейсу БД:
В качестве интерфейса БД использовалась консоль h2, к которой можно подключиться
по URL: http://localhost:8080/h2-console
- **Driver Class:** org.h2.Driver
- **JDBC URL:** jdbc:h2:mem:shopdb
- **User Name:** sa
- **Password:**   (нет пароля, ничего вводить не надо)


## Как происходит обработка запроса:
- URL запроса приходит на контроллер конкретного товара (или на ShopController), где DTO преобразуется в сущность товара.
- Сущность товара передаются в сервис товара
- В сервисе происходит обращение к конкретному методу репозиторию товара, который уже работает с базой данных
- В качестве стандартного репозитория использовался **CrudRepository** из **Spring Data JPA**

Получается вот такая вот многослойная архитектура)))


#### application.properties file:
````
    #H2
    spring.datasource.url=jdbc:h2:mem:shopdb
    spring.datasource.driverClassName=org.h2.Driver
    spring.datasource.username=sa
    spring.datasource.password=
    spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

    #enabling the H2 console
    spring.h2.console.enabled=true
````    


## Как выполнять запросы.
#### Получение товара (Просмотр всех существующих товаров по типу):
#### (GET-запрос)
- http://localhost:8080/shop (возвращает все товары)
- http://localhost:8080/shop/hdd (возвращает все жесткие диски)
- http://localhost:8080/shop/laptop (возвращает все ноутбуки)
- http://localhost:8080/shop/pc (возвращает все ПК)
- http://localhost:8080/shop/screen (возвращает все мониторы)

#### Просмотр товара по идентификатору:
#### (GET-запрос)
- http://localhost:8080/shop/{id} (возвращает конкретный товар по идентификатору)

#### Добавление товара:
#### (POST-запрос)
- http://localhost:8080/shop/hdd/add (добавляет жесткий диск из тела запроса в БД)
- http://localhost:8080/shop/laptop/add (добавляет ноутбук из тела запроса в БД)
- http://localhost:8080/shop/pc/add (добавляет ПК из тела запроса в БД)
- http://localhost:8080/shop/screen/add (добавляет монитор из тела запроса в БД)

- так же вместо **add** можно использовать **addlist**, чтобы добавить список товаров

#### Редактирование товара (заменяет только те поля, которые присутствуют в теле запроса):
#### (PUT-запрос)
- http://localhost:8080/shop/hdd/update/{id} 
- http://localhost:8080/shop/laptop/update/{id} 
- http://localhost:8080/shop/pc/update/{id} 
- http://localhost:8080/shop/screen/update/{id} 

Для редактирование в теле запроса достаточно указать лишь часть из полей сущности.

#### Удаление товара:
#### (DELETE-запрос)
- http://localhost:8080/shop/{id} 

Проверка всех запросов производилась через **Postman** 

## Шаблоны тела запроса для добавления товаров:
#### Hdd:
````
    {
        "type": "hdd",
        "serial": "355722",
        "manufacturer": "Samsung",
        "cost": "100",
        "amount": "38",
        "capacity": "1000"
    },
    {
        "type": "hdd",
        "serial": "934324",
        "manufacturer": "IBM",
        "cost": "300",
        "amount": "5",
        "capacity": "5000"
    }
````
#### Laptop:
````
    {
        "type": "laptop",
        "serial": "2281337",
        "manufacturer": "HP",
        "cost": "300",
        "amount": "10",
        "diagonal": "15"
    },
	{
        "type": "laptop",
        "serial": "234321",
        "manufacturer": "MSI",
        "cost": "500",
        "amount": "3",
        "diagonal": "17"
    }
````
#### Screen:
````
    {
        "type": "screen",
        "serial": "77281337",
        "manufacturer": "LG",
        "cost": "150",
        "amount": "15",
        "diagonal": "21"
    },
		{
        "type": "screen",
        "serial": "944693385",
        "manufacturer": "Xiaomi",
        "cost": "300",
        "amount": "6",
        "diagonal": "17"
    }
````
#### Pc:
````
    {
        "type": "pc",
        "serial": "10281337",
        "manufacturer": "Apple",
        "cost": "1000",
        "amount": "20",
        "pcType": "monoblock"
    },
		{
        "type": "screen",
        "serial": "944693385",
        "manufacturer": "Lenovo",
        "cost": "500",
        "amount": "6",
        "pcType": "desktop"
    }
````